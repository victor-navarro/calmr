<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>ANCCR • calmr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ANCCR">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">calmr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/calmr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Model reference</h6></li>
    <li><a class="dropdown-item" href="../articles/model_parameters.html">model_parameters</a></li>
    <li><a class="dropdown-item" href="../articles/RW1972.html">RW1972</a></li>
    <li><a class="dropdown-item" href="../articles/MAC1975.html">MAC1975</a></li>
    <li><a class="dropdown-item" href="../articles/PKH1982.html">PKH1982</a></li>
    <li><a class="dropdown-item" href="../articles/SM2007.html">SM2007</a></li>
    <li><a class="dropdown-item" href="../articles/HD2022.html">HD2022</a></li>
    <li><a class="dropdown-item" href="../articles/ANCCR.html">ANCCR</a></li>
    <li><a class="dropdown-item" href="../articles/TD.html">TD</a></li>
    <li><a class="dropdown-item" href="../articles/RAND.html">RAND</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Demos</h6></li>
    <li><a class="dropdown-item" href="../articles/calmr_app.html">calmr_app</a></li>
    <li><a class="dropdown-item" href="../articles/calmr_fits.html">calmr_fits</a></li>
    <li><a class="dropdown-item" href="../articles/parallelism_in_calmr.html">parallelism_in_calmr</a></li>
    <li><a class="dropdown-item" href="../articles/directional_models.html">directional_models</a></li>
    <li><a class="dropdown-item" href="../articles/using_time_models.html">using_time_models</a></li>
    <li><a class="dropdown-item" href="../articles/heidi_similarity.html">heidi_similarity</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/victor-navarro/calmr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="ANCCR_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="ANCCR_files/d3-3.3.8/d3.min.js"></script><script src="ANCCR_files/dagre-0.4.0/dagre-d3.min.js"></script><link href="ANCCR_files/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet">
<script src="ANCCR_files/mermaid-0.3.0/dist/mermaid.slim.min.js"></script><link href="ANCCR_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="ANCCR_files/chromatography-0.1/chromatography.js"></script><script src="ANCCR_files/DiagrammeR-binding-1.0.11/DiagrammeR.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>ANCCR</h1>
                        <h4 data-toc-skip class="author">Victor
Navarro</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/victor-navarro/calmr/blob/main/vignettes/ANCCR.Rmd" class="external-link"><code>vignettes/ANCCR.Rmd</code></a></small>
      <div class="d-none name"><code>ANCCR.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="the-mathematics-behind-anccr">The mathematics behind ANCCR<a class="anchor" aria-label="anchor" href="#the-mathematics-behind-anccr"></a>
</h2>
<p>The ANCCR <span class="citation">(Jeong et al., 2022)</span> model,
which stands for adjusted net contingency for causal relations, proposes
that mesolimbic dopaminergic conveys an adjusted net contingency for
causal relationships (to biologically meaningful targets). The
mathematics (and logic) behind the model go well beyond what I can cover
here, but for now, it will suffice to say that the model:</p>
<ul>
<li>Uses a “Hebbian” mechanism to learn retrospective associations after
experiencing a meaningful causal target.</li>
<li>Derives prospective associations using Bayes’s rule.</li>
<li>Combines those associations into contingency terms that represent
dopaminergic activity.</li>
<li>Uses the sign of dopaminergic activity to strengthen or weaken
causal weights.</li>
<li>Responds as a function of prospective associations and causal
links.</li>
</ul>
<div class="section level3">
<h3 id="maintaining-stimulus-representations">1 - Maintaining stimulus representations<a class="anchor" aria-label="anchor" href="#maintaining-stimulus-representations"></a>
</h3>
<p>The degree to which a stimulus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
is “active” in memory is denoted by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Σ</mi><mrow><msub><mi>t</mi><mi>i</mi></msub><mo>≤</mo><mi>t</mi></mrow></msub><msup><mi>e</mi><mrow><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>t</mi><mo>−</mo><msub><mi>t</mi><mi>i</mi></msub></mrow><mrow><mi>t</mi><mi>_</mi><mi>c</mi><mi>o</mi><mi>n</mi><mi>s</mi><mi>t</mi><mi>a</mi><mi>n</mi><mi>t</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup></mrow><annotation encoding="application/x-tex">
\tag{Eq.1}
E_i(t) = \Sigma_{t_i \leq t}e^{-(\frac{t-t_i}{t\_constant})}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>i</mi></msub><annotation encoding="application/x-tex">t_i</annotation></semantics></math>
are all the time steps up to time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>_</mi><mi>c</mi><mi>o</mi><mi>n</mi><mi>s</mi><mi>t</mi><mi>a</mi><mi>n</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">t\_constant</annotation></semantics></math>
is a time constant (usually meant to be the inter-reward rate)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The
&lt;math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;_&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding="application/x-tex"&gt;t\_constant&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;
defaults to &lt;code&gt;NA&lt;/code&gt;, and if it remains like that, is calculated
internally as the mean of the mean ITI for each trial. You should set
this by hand if only some of your trials contain rewards.&lt;/p&gt;'><sup>1</sup></a></p>
</div>
<div class="section level3">
<h3 id="learning-stimulus-associations">2 - Learning stimulus associations:<a class="anchor" aria-label="anchor" href="#learning-stimulus-associations"></a>
</h3>
<p>The model learns retrospective associations after meaningful causal
targets occur. Whether event
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
is a meaningful causal target is given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Φ</mi><mi>j</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>Φ</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>D</mi><msub><mi>A</mi><mi>j</mi></msub><mo>+</mo><msub><mi>β</mi><mi>j</mi></msub><mo>&gt;</mo><mi>θ</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\tag{Eq.2}
\Phi_j = \begin{cases}
    1,&amp; \text{if } \Phi_j(t) = 1\\
    1,&amp; \text{if }DA_j + \beta_j &gt; \theta\\
    0,&amp; \text{otherwise}
\end{cases}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Φ</mi><annotation encoding="application/x-tex">\Phi</annotation></semantics></math>
plays the role of an indicator function,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><msub><mi>A</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">DA_j</annotation></semantics></math>
is the total dopamine activity at the time of event
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\beta_j</annotation></semantics></math>
is the unconditioned value of event
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
is a global threshold parameter.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The first case in Eq. 2 was not written in the
supplementary information of the Jeong et al. paper, but it reflects
their MATLAB implementation.&lt;/p&gt;"><sup>2</sup></a> Note that the indicator function is
self-preserving: once a stimulus becomes a meaningful causal target, it
does not stop being so.</p>
<p>After stimulus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
is observed, the predecessor representation contingency, or
<strong>PRC</strong>, for each stimulus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is updated via:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>R</mi><msub><mi>C</mi><mrow><mi>i</mi><mo>←</mo><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>M</mi><mrow><mi>i</mi><mo>←</mo><mi>j</mi></mrow></msub><mo>−</mo><msub><mi>M</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">
\tag{Eq.3}
PRC_{i \leftarrow j} = M_{i \leftarrow j} - M_{i}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>M</mi><mrow><mi>i</mi><mo>←</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">M_{i \leftarrow j}</annotation></semantics></math>
is the predecessor representation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
has occurred, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>M</mi><mi>i</mi></msub><annotation encoding="application/x-tex">M_{i}</annotation></semantics></math>
is the base rate with which
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
occurs. Both of these quantities are given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mrow><mi>i</mi><mo>←</mo><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>M</mi><mrow><mi>i</mi><mo>←</mo><mi>j</mi></mrow></msub><mi>′</mi><mo>+</mo><msub><mi>Φ</mi><mi>j</mi></msub><mi>α</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>E</mi><mrow><mi>i</mi><mo>←</mo><mi>j</mi></mrow></msub><mo>−</mo><msub><mi>M</mi><mrow><mi>i</mi><mo>←</mo><mi>j</mi></mrow></msub><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\tag{Eq.4a}
M_{i \leftarrow j} = M_{i \leftarrow j}' + \Phi_j\alpha(E_{i \leftarrow j}  -  M_{i \leftarrow j}') 
</annotation></semantics></math></p>
<p>and</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>i</mi></msub><mo>=</mo><msub><mi>M</mi><mi>i</mi></msub><mi>′</mi><mo>+</mo><mi>k</mi><mi>α</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>E</mi><mi>i</mi></msub><mo>−</mo><msub><mi>M</mi><mi>i</mi></msub><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\tag{Eq.4b}
M_{i} = M_{i}' + k\alpha(E_{i}  -  M_{i}') 
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mrow><mi>i</mi><mo>←</mo><mi>j</mi></mrow></msub><mi>′</mi></mrow><annotation encoding="application/x-tex">M_{i \leftarrow j}'</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>i</mi></msub><mi>′</mi></mrow><annotation encoding="application/x-tex">M_{i}'</annotation></semantics></math>
are the quantities before
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
was observed,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
are learning rate parameters, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mrow><mi>i</mi><mo>←</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">E_{i \leftarrow j}</annotation></semantics></math>
is the eligibility trace of stimulus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
at the time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
occurs (see Eq. 1).</p>
<p>Then, the PRC can be used to derive the prospective association,
aptly named the successor representation contingency, or
<strong>SRC</strong> via Bayes rule:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>R</mi><msub><mi>C</mi><mrow><mi>i</mi><mo>→</mo><mi>j</mi></mrow></msub><mo>=</mo><mi>P</mi><mi>R</mi><msub><mi>C</mi><mrow><mi>i</mi><mo>←</mo><mi>j</mi></mrow></msub><mfrac><msub><mi>M</mi><mi>j</mi></msub><msub><mi>M</mi><mi>i</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">
\tag{Eq.5}
SRC_{i \rightarrow j} = PRC_{i \leftarrow j} \frac{M_j}{M_i}
</annotation></semantics></math></p>
<p>The base rate for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>M</mi><mi>j</mi></msub><annotation encoding="application/x-tex">M_j</annotation></semantics></math>
is calculated via Eq.4b.</p>
</div>
<div class="section level3">
<h3 id="releasing-dopamine">3 - Releasing Dopamine<a class="anchor" aria-label="anchor" href="#releasing-dopamine"></a>
</h3>
<p>The model postulates that dopaminergic signaling encodes the adjusted
net contingencies for causal relations between stimuli, or ANCCRs. The
total dopaminergic activity at the time of event
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is equal to:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><msub><mi>A</mi><mi>i</mi></msub><mo>=</mo><msub><mi>Σ</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mi>N</mi><mi>C</mi><mi>C</mi><msub><mi>R</mi><mrow><mi>i</mi><mo>→</mo><mi>j</mi></mrow></msub><msub><mi>Φ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\tag{Eq.6}
DA_i = \Sigma_j (ANCCR_{i \rightarrow j}\Phi_j)
</annotation></semantics></math></p>
<p>And the ANCCR from stimulus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
to stimulus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
is given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>N</mi><mi>C</mi><mi>C</mi><msub><mi>R</mi><mrow><mi>i</mi><mo>→</mo><mi>j</mi></mrow></msub><mo>=</mo><mi>N</mi><msub><mi>C</mi><mrow><mi>i</mi><mo>↔</mo><mi>j</mi></mrow></msub><mi>C</mi><msub><mi>W</mi><mrow><mi>i</mi><mo>→</mo><mi>j</mi></mrow></msub><mo>−</mo><munder><mo>∑</mo><mrow><mi>k</mi><mo>≠</mo><mi>i</mi></mrow></munder><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mi>N</mi><mi>C</mi><mi>C</mi><msub><mi>R</mi><mrow><mi>k</mi><mo>↔</mo><mi>j</mi></mrow></msub><msub><mi>Δ</mi><mrow><mi>k</mi><mo>←</mo><mi>i</mi></mrow></msub><msub><mi>Φ</mi><mrow><mi>k</mi><mo>↔</mo><mi>i</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\tag{Eq.7}
ANCCR_{i \rightarrow j} = NC_{i \leftrightarrow j} CW_{i \rightarrow j} - \sum_{k \neq i}(ANCCR_{k \leftrightarrow j}\Delta_{k \leftarrow i}\Phi_{k \leftrightarrow i})
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><msub><mi>C</mi><mrow><mi>i</mi><mo>↔</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">NC_{i \leftrightarrow j}</annotation></semantics></math>
is the net contingency between stimuli
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><msub><mi>W</mi><mrow><mi>i</mi><mo>→</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">CW_{i \rightarrow j}</annotation></semantics></math>
is the causal weight that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
has with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Δ</mi><mrow><mi>k</mi><mo>←</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\Delta_{k \leftarrow i}</annotation></semantics></math>
is the recency of stimulus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
with respect to stimulus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Φ</mi><mrow><mi>k</mi><mo>↔</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\Phi_{k \leftrightarrow i}</annotation></semantics></math>
is an indicator function denoting whether
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
have a putative causal relationship with each other.</p>
<p>The net contingency between stimuli
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><msub><mi>C</mi><mrow><mi>i</mi><mo>↔</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">NC_{i \leftrightarrow j}</annotation></semantics></math>,
is given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><msub><mi>C</mi><mrow><mi>i</mi><mo>↔</mo><mi>j</mi></mrow></msub><mo>=</mo><mi>w</mi><mi>S</mi><mi>R</mi><msub><mi>C</mi><mrow><mi>i</mi><mo>→</mo><mi>j</mi></mrow></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>P</mi><mi>R</mi><msub><mi>C</mi><mrow><mi>i</mi><mo>←</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
\tag{Eq.8}
NC_{i \leftrightarrow j} = wSRC_{i \rightarrow j} + (1-w)PRC_{i \leftarrow j}
</annotation></semantics></math></p>
<p>or a weighted sum of successor and predecessor representation
contingencies.</p>
<p>The net contingency is used to calculate the indicator function
above, as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Φ</mi><mrow><mi>k</mi><mo>↔</mo><mi>i</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>N</mi><msub><mi>C</mi><mrow><mi>i</mi><mo>↔</mo><mi>j</mi></mrow></msub><mo>&gt;</mo><mi>θ</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\tag{Eq.9}
\Phi_{k \leftrightarrow i} = \begin{cases}
    1,&amp; \text{if } NC_{i \leftrightarrow j} &gt; \theta\\
    0,&amp; \text{otherwise}
\end{cases}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
is the same threshold parameter used in Eq.2<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Notably, although Eq.2 is self-perpetuating, Eq.9 is
not, meaning causal relations between stimuli can flip between 0 and 1&lt;/p&gt;"><sup>3</sup></a>, and the indicator
function for a stimulus and itself,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Φ</mi><mrow><mi>i</mi><mo>↔</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\Phi_{i \leftrightarrow i}</annotation></semantics></math>,
is 0.</p>
<p>The recency term,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Δ</mi><mrow><mi>k</mi><mo>←</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\Delta_{k \leftarrow i}</annotation></semantics></math>,
is given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Δ</mi><mrow><mi>k</mi><mo>←</mo><mi>i</mi></mrow></msub><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msub><mi>t</mi><mi>j</mi></msub><mo>−</mo><msub><mi>t</mi><mi>i</mi></msub></mrow><mrow><mi>t</mi><mi>_</mi><mi>c</mi><mi>o</mi><mi>n</mi><mi>s</mi><mi>t</mi><mi>a</mi><mi>n</mi><mi>t</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup></mrow><annotation encoding="application/x-tex">
\tag{Eq.10}
\Delta_{k \leftarrow i} = e^{-(\frac{t_j-t_i}{t\_constant})}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>_</mi><mi>c</mi><mi>o</mi><mi>n</mi><mi>s</mi><mi>t</mi><mi>a</mi><mi>n</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">t\_constant</annotation></semantics></math>
is the same parameter used in Eq.1. Note however that Eq.9 does not
include the sum term in Eq. 1. Finally, the causal weight from stimulus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
to stimulus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
is given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><msub><mi>W</mi><mrow><mi>i</mi><mo>→</mo><mi>j</mi></mrow></msub><mo>=</mo><mi>C</mi><msub><mi>W</mi><mrow><mi>i</mi><mo>→</mo><mi>j</mi></mrow></msub><mi>′</mi><mo>+</mo><msub><mi>α</mi><mrow><mi>r</mi><mi>e</mi><mi>w</mi><mi>a</mi><mi>r</mi><mi>d</mi></mrow></msub><msub><mi>δ</mi><mrow><mi>i</mi><mo>→</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
\tag{Eq.11}
CW_{i \rightarrow j} = CW_{i \rightarrow j}' + \alpha_{reward}\delta_{i \rightarrow j}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><msub><mi>W</mi><mrow><mi>i</mi><mo>→</mo><mi>j</mi></mrow></msub><mi>′</mi></mrow><annotation encoding="application/x-tex">CW_{i \rightarrow j}'</annotation></semantics></math>
is the previous causal weight,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mrow><mi>r</mi><mi>e</mi><mi>w</mi><mi>a</mi><mi>r</mi><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">\alpha_{reward}</annotation></semantics></math>
is a learning rate parameter exclusive for causal weights, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>δ</mi><mrow><mi>i</mi><mo>→</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\delta_{i \rightarrow j}</annotation></semantics></math>
is a delta term depending on the sign of the total dopaminergic
activity, given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mrow><mi>i</mi><mo>→</mo><mi>j</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mi>C</mi><msub><mi>W</mi><mrow><mi>j</mi><mo>→</mo><mi>j</mi></mrow></msub><mo>−</mo><mi>C</mi><msub><mi>W</mi><mrow><mi>i</mi><mo>→</mo><mi>j</mi></mrow></msub><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>D</mi><msub><mi>A</mi><mi>j</mi></msub><mo>≥</mo><mn>0</mn></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>−</mo><mi>C</mi><msub><mi>W</mi><mrow><mi>i</mi><mo>→</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><mrow><msubsup><mi>n</mi><mi>i</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mi>Δ</mi><mrow><mi>i</mi><mo>←</mo><mi>j</mi></mrow><msub><mi>Φ</mi><mrow><mi>i</mi><mo>↔</mo><mi>j</mi></mrow></msub></mrow><mrow><msub><mi>Σ</mi><mrow><mi>k</mi><mo>≠</mo><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>n</mi><mi>k</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>Δ</mi><mrow><mi>k</mi><mo>←</mo><mi>j</mi></mrow></msub><msub><mi>Φ</mi><mrow><mi>k</mi><mo>↔</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\tag{Eq.12}
\delta_{i \rightarrow j} = \begin{cases}
    CW_{j \rightarrow j} - CW_{i \rightarrow j}, &amp; \text{if } DA_j \ge 0\\
    (0-CW_{i \rightarrow j})\frac{n_i^{-1}\Delta{i \leftarrow j} \Phi_{i \leftrightarrow j}}{\Sigma_{k \neq j}(n_k^{-1}\Delta_{k \leftarrow j} \Phi_{k \leftrightarrow j})},&amp; \text{otherwise}
\end{cases}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><msub><mi>W</mi><mrow><mi>j</mi><mo>→</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">CW_{j \rightarrow j}</annotation></semantics></math>
above is the reward magnitude of stimulus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>.
In plain words, when dopaminergic activity is positive, causal weights
(from all present and absent stimuli) strengthen. Conversely, when
dopaminergic activity is negative, causal weights (from all present and
absent stimuli) weaken, proportional to their normalized frequency and
recency (as long as they have putative causal relations with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>).</p>
</div>
<div class="section level3">
<h3 id="generating-responses">4 - Generating responses<a class="anchor" aria-label="anchor" href="#generating-responses"></a>
</h3>
<p>Responding in ANCCR is lightly specified. The value of responding
upon presentation of stimulus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mi>i</mi></msub><mo>=</mo><msub><mi>Σ</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mi>R</mi><msub><mi>C</mi><mrow><mi>i</mi><mo>→</mo><mi>k</mi></mrow></msub><mi>C</mi><msub><mi>W</mi><mrow><mi>i</mi><mo>→</mo><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\tag{Eq.13}
Q_i = \Sigma_k(SRC_{i \rightarrow k} CW_{i \rightarrow k})
</annotation></semantics></math></p>
<p>which can then be mapped onto probabilities via a softmax function<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The implementation of ANCCR in &lt;code&gt;calmr&lt;/code&gt;
returns both action values and probability matrices. The latter is
parametrized via the global parameters
&lt;math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding="application/x-tex"&gt;cost&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;
(the cost of responding) and
&lt;math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding="application/x-tex"&gt;temperature&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;,
a multiplier, &lt;strong&gt;not divider&lt;/strong&gt; on action values&lt;/p&gt;'><sup>4</sup></a>.</p>
<div class="section level5">
<h5 id="a-diagram">A diagram<a class="anchor" aria-label="anchor" href="#a-diagram"></a>
</h5>
<p>The diagram below shows the dependencies in the model. I am excluding
the indicator functions and parameters for simplicity.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;If nothing appears below, try rebuilding this vignette
after install &lt;code&gt;DiagrammeR&lt;/code&gt;&lt;/p&gt;"><sup>5</sup></a></p>
<div id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:432.632880098888px;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"diagram":"graph LR;\n    E_i-->M_i;\n    E_j-->M_j;\n    M_j-->SRC;\n    M_i-->SRC;\n    E_ij-->M_ij;\n    M_ij-->PRC;\n    M_i-->PRC;\n    PRC-->SRC;\n    PRC-->NC;\n    SRC-->NC;\n    NC-->ANCCR;\n    CW-->ANCCR;\n    ANCCR-->DA;\n    DA-->CW;\n    CW-->Q;\n    SRC-->Q;\n"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level5">
<h5 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h5>
<p>The implementation of this model is a port from the MATLAB code that
Jeong et al. shared in the <a href="https://github.com/namboodirilab/ANCCR" class="external-link">GitHub repository</a>
associated with their paper. The output of the R model was checked
against the outputs of the MATLAB model, using training routines
(“eventlogs” in their parlance) generated using their MATLAB code. The
training routines generated in <code>calmr</code> differ somewhat, to
accommodate generality. For example, as of version <code>0.6.1</code>,
it is not possible to specify probabilistic relations between cues and
rewards. Instead, it is left to the user to specify an exact probability
via trial numbers (e.g., an 80% reward probability can be specified as
“80A&gt;(US)/20A”). The naming of parameters also differs between
codebases.</p>
</div>
<div class="section level5">
<h5 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h5>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-jeong_mesolimbic_2022" class="csl-entry">
Jeong, H., Taylor, A., Floeder, J. R., Lohmann, M., Mihalas, S., Wu, B.,
Zhou, M., Burke, D. A., &amp; Namboodiri, V. M. K. (2022). Mesolimbic
dopamine release conveys causal associations. <em>Science (New York,
N.Y.)</em>, <em>378</em>, eabq6740. <a href="https://doi.org/10.1126/science.abq6740" class="external-link">https://doi.org/10.1126/science.abq6740</a>
</div>
</div>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Victor Navarro.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
